"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1002],{53245:function(e,s,t){t.d(s,{d:function(){return x},f:function(){return p}});var n=t(57437),l=t(62869),r=t(94508),a=t(30401),i=t(78867),o=t(2265),d=t(34996),c=t(1479),u=t(9880);let m=(0,o.createContext)({code:""}),x=e=>{let{code:s,language:t,showLineNumbers:l=!1,className:a,children:i,...o}=e;return(0,n.jsx)(m.Provider,{value:{code:s},children:(0,n.jsx)("div",{className:(0,r.cn)("relative w-full overflow-hidden rounded-md border bg-background text-foreground",a),...o,children:(0,n.jsxs)("div",{className:"relative",children:[(0,n.jsx)(d.Z,{className:"overflow-hidden dark:hidden",codeTagProps:{className:"font-mono text-sm"},customStyle:{margin:0,padding:"1rem",fontSize:"0.875rem",background:"hsl(var(--background))",color:"hsl(var(--foreground))"},language:t,lineNumberStyle:{color:"hsl(var(--muted-foreground))",paddingRight:"1rem",minWidth:"2.5rem"},showLineNumbers:l,style:c.Z,children:s}),(0,n.jsx)(d.Z,{className:"hidden overflow-hidden dark:block",codeTagProps:{className:"font-mono text-sm"},customStyle:{margin:0,padding:"1rem",fontSize:"0.875rem",background:"hsl(var(--background))",color:"hsl(var(--foreground))"},language:t,lineNumberStyle:{color:"hsl(var(--muted-foreground))",paddingRight:"1rem",minWidth:"2.5rem"},showLineNumbers:l,style:u.Z,children:s}),i&&(0,n.jsx)("div",{className:"absolute top-2 right-2 flex items-center gap-2",children:i})]})})})},p=e=>{let{onCopy:s,onError:t,timeout:d=2e3,children:c,className:u,...x}=e,[p,h]=(0,o.useState)(!1),{code:f}=(0,o.useContext)(m),g=async()=>{if(!navigator.clipboard.writeText){null==t||t(Error("Clipboard API not available"));return}try{await navigator.clipboard.writeText(f),h(!0),null==s||s(),setTimeout(()=>h(!1),d)}catch(e){null==t||t(e)}},j=p?a.Z:i.Z;return(0,n.jsx)(l.z,{className:(0,r.cn)("shrink-0",u),onClick:g,size:"icon",variant:"ghost",...x,children:null!=c?c:(0,n.jsx)(j,{size:14})})}},27182:function(e,s,t){t.d(s,{iG:function(){return i},ri:function(){return a}});var n=t(57437);t(62869);var l=t(94508);t(2265);var r=t(20460);let a=e=>{let{className:s,...t}=e;return(0,n.jsx)(r.h,{className:(0,l.cn)("relative flex-1 overflow-y-auto",s),initial:"smooth",resize:"smooth",role:"log",...t})},i=e=>{let{className:s,...t}=e;return(0,n.jsx)(r.h.Content,{className:(0,l.cn)("p-4",s),...t})}},35629:function(e,s,t){t.d(s,{H:function(){return x}});var n=t(57437),l=t(94508),r=t(2265),a=t(86816),i=t(67245),o=t(58146),d=t(85020),c=t(53245);t(2446);let u=(0,t(86589).Z)(a.UG),m={ol:e=>{let{node:s,children:t,className:r,...a}=e;return(0,n.jsx)("ol",{className:(0,l.cn)("ml-4 list-outside list-decimal",r),...a,children:t})},li:e=>{let{node:s,children:t,className:r,...a}=e;return(0,n.jsx)("li",{className:(0,l.cn)("py-1",r),...a,children:t})},ul:e=>{let{node:s,children:t,className:r,...a}=e;return(0,n.jsx)("ul",{className:(0,l.cn)("ml-4 list-outside list-disc",r),...a,children:t})},hr:e=>{let{node:s,className:t,...r}=e;return(0,n.jsx)("hr",{className:(0,l.cn)("my-6 border-border",t),...r})},strong:e=>{let{node:s,children:t,className:r,...a}=e;return(0,n.jsx)("span",{className:(0,l.cn)("font-semibold",r),...a,children:t})},a:e=>{let{node:s,children:t,className:r,...a}=e;return(0,n.jsx)("a",{className:(0,l.cn)("font-medium text-primary underline",r),rel:"noreferrer",target:"_blank",...a,children:t})},h1:e=>{let{node:s,children:t,className:r,...a}=e;return(0,n.jsx)("h1",{className:(0,l.cn)("mt-6 mb-2 font-semibold text-3xl",r),...a,children:t})},h2:e=>{let{node:s,children:t,className:r,...a}=e;return(0,n.jsx)("h2",{className:(0,l.cn)("mt-6 mb-2 font-semibold text-2xl",r),...a,children:t})},h3:e=>{let{node:s,children:t,className:r,...a}=e;return(0,n.jsx)("h3",{className:(0,l.cn)("mt-6 mb-2 font-semibold text-xl",r),...a,children:t})},h4:e=>{let{node:s,children:t,className:r,...a}=e;return(0,n.jsx)("h4",{className:(0,l.cn)("mt-6 mb-2 font-semibold text-lg",r),...a,children:t})},h5:e=>{let{node:s,children:t,className:r,...a}=e;return(0,n.jsx)("h5",{className:(0,l.cn)("mt-6 mb-2 font-semibold text-base",r),...a,children:t})},h6:e=>{let{node:s,children:t,className:r,...a}=e;return(0,n.jsx)("h6",{className:(0,l.cn)("mt-6 mb-2 font-semibold text-sm",r),...a,children:t})},table:e=>{let{node:s,children:t,className:r,...a}=e;return(0,n.jsx)("div",{className:"my-4 overflow-x-auto",children:(0,n.jsx)("table",{className:(0,l.cn)("w-full border-collapse border border-border",r),...a,children:t})})},thead:e=>{let{node:s,children:t,className:r,...a}=e;return(0,n.jsx)("thead",{className:(0,l.cn)("bg-muted/50",r),...a,children:t})},tbody:e=>{let{node:s,children:t,className:r,...a}=e;return(0,n.jsx)("tbody",{className:(0,l.cn)("divide-y divide-border",r),...a,children:t})},tr:e=>{let{node:s,children:t,className:r,...a}=e;return(0,n.jsx)("tr",{className:(0,l.cn)("border-border border-b",r),...a,children:t})},th:e=>{let{node:s,children:t,className:r,...a}=e;return(0,n.jsx)("th",{className:(0,l.cn)("px-4 py-2 text-left font-semibold text-sm",r),...a,children:t})},td:e=>{let{node:s,children:t,className:r,...a}=e;return(0,n.jsx)("td",{className:(0,l.cn)("px-4 py-2 text-sm",r),...a,children:t})},blockquote:e=>{let{node:s,children:t,className:r,...a}=e;return(0,n.jsx)("blockquote",{className:(0,l.cn)("my-4 border-muted-foreground/30 border-l-4 pl-4 text-muted-foreground italic",r),...a,children:t})},code:e=>{var s,t;let{node:r,className:a,...i}=e;return(null==r?void 0:null===(s=r.position)||void 0===s?void 0:s.start.line)!==(null==r?void 0:null===(t=r.position)||void 0===t?void 0:t.end.line)?(0,n.jsx)("code",{className:a,...i}):(0,n.jsx)("code",{className:(0,l.cn)("rounded bg-muted px-1.5 py-0.5 font-mono text-sm",a),...i})},pre:e=>{var s;let{node:t,className:a,children:i}=e,o="javascript";"string"==typeof(null==t?void 0:null===(s=t.properties)||void 0===s?void 0:s.className)&&(o=t.properties.className.replace("language-",""));let d="";return(0,r.isValidElement)(i)&&i.props&&"string"==typeof i.props.children?d=i.props.children:"string"==typeof i&&(d=i),(0,n.jsx)(c.d,{className:(0,l.cn)("my-4 h-auto",a),code:d,language:o,children:(0,n.jsx)(c.f,{onCopy:()=>console.log("Copied code to clipboard"),onError:()=>console.error("Failed to copy code to clipboard")})})}},x=(0,r.memo)(e=>{let{className:s,options:t,children:r,allowedImagePrefixes:a,allowedLinkPrefixes:c,defaultOrigin:x,parseIncompleteMarkdown:p=!0,...h}=e,f="string"==typeof r&&p?function(e){if(!e||"string"!=typeof e)return e;let s=e,t=s.match(/(!?\[)([^\]]*?)$/);if(t){let e=s.lastIndexOf(t[1]);s=s.substring(0,e)}if(s.match(/(\*\*)([^*]*?)$/)&&(s.match(/\*\*/g)||[]).length%2==1&&(s="".concat(s,"**")),s.match(/(__)([^_]*?)$/)&&(s.match(/__/g)||[]).length%2==1&&(s="".concat(s,"__")),s.match(/(\*)([^*]*?)$/)&&s.split("").reduce((e,t,n)=>{if("*"===t){let t=s[n-1],l=s[n+1];if("*"!==t&&"*"!==l)return e+1}return e},0)%2==1&&(s="".concat(s,"*")),s.match(/(_)([^_]*?)$/)&&s.split("").reduce((e,t,n)=>{if("_"===t){let t=s[n-1],l=s[n+1];if("_"!==t&&"_"!==l)return e+1}return e},0)%2==1&&(s="".concat(s,"_")),s.match(/(`)([^`]*?)$/)&&(s.includes("```"),(s.match(/```[\s\S]*?```/g)||[]).length,(s.match(/```/g)||[]).length%2!=1)){let e=0;for(let t=0;t<s.length;t++)if("`"===s[t]){let n="```"===s.substring(t,t+3),l=t>0&&"```"===s.substring(t-1,t+2),r=t>1&&"```"===s.substring(t-2,t+1);!(n||l||r)&&e++}e%2==1&&(s="".concat(s,"`"))}return s.match(/(~~)([^~]*?)$/)&&(s.match(/~~/g)||[]).length%2==1&&(s="".concat(s,"~~")),s}(r):r;return(0,n.jsx)("div",{className:(0,l.cn)("size-full [&>*:first-child]:mt-0 [&>*:last-child]:mb-0",s),...h,children:(0,n.jsx)(u,{allowedImagePrefixes:null!=a?a:["*"],allowedLinkPrefixes:null!=c?c:["*"],components:m,defaultOrigin:x,rehypePlugins:[i.Z],remarkPlugins:[o.Z,d.Z],...t,children:f})})},(e,s)=>e.children===s.children);x.displayName="Response"},69836:function(e,s,t){t.d(s,{K:function(){return L}});var n=t(57437);t(16831);var l=t(94508);let r=e=>{let{className:s,from:t,...r}=e;return(0,n.jsx)("div",{className:(0,l.cn)("group flex w-full items-end justify-end gap-2 py-4","user"===t?"is-user flex-row-reverse justify-end":"is-assistant flex-row-reverse justify-end","[&>div]:max-w-[80%]",s),...r})},a=e=>{let{children:s,className:t,...r}=e;return(0,n.jsx)("div",{className:(0,l.cn)("flex flex-col gap-2 overflow-hidden rounded-lg py-3 text-foreground text-sm","group-[.is-user]:bg-secondary group-[.is-user]:text-primary-foreground group-[.is-user]:px-4","group-[.is-assistant]:bg-transparent group-[.is-assistant]:text-foreground",t),...r,children:(0,n.jsx)("div",{className:"is-user:dark",children:s})})};var i=t(62869),o=t(81103);let d=e=>{let{className:s,children:t,...r}=e;return(0,n.jsx)("div",{className:(0,l.cn)("flex items-center gap-1",s),...r,children:t})},c=e=>{let{tooltip:s,children:t,label:r,className:a,variant:d="ghost",size:c="sm",...u}=e,m=(0,n.jsxs)(i.z,{className:(0,l.cn)("size-9 p-1.5 text-muted-foreground hover:text-foreground",a),size:c,type:"button",variant:d,...u,children:[t,(0,n.jsx)("span",{className:"sr-only",children:r||s})]});return s?(0,n.jsx)(o.pn,{children:(0,n.jsxs)(o.u,{children:[(0,n.jsx)(o.aJ,{asChild:!0,children:m}),(0,n.jsx)(o._v,{children:(0,n.jsx)("p",{children:s})})]})}):m};var u=t(35629),m=t(80886),x=t(74928),p=t(64972),h=t(40875),f=t(2265);let g=(0,f.createContext)(null),j=()=>{let e=(0,f.useContext)(g);if(!e)throw Error("Reasoning components must be used within Reasoning");return e},v=(0,f.memo)(e=>{let{className:s,isStreaming:t=!1,open:r,defaultOpen:a=!1,onOpenChange:i,duration:o,children:d,...c}=e,[u,p]=(0,m.T)({prop:r,defaultProp:a,onChange:i}),[h,j]=(0,m.T)({prop:o,defaultProp:0}),[v,N]=(0,f.useState)(!1),[b,y]=(0,f.useState)(null);return(0,f.useEffect)(()=>{t?null===b&&y(Date.now()):null!==b&&(j(Math.round((Date.now()-b)/1e3)),y(null))},[t,b,j]),(0,f.useEffect)(()=>{if(t&&!u)p(!0);else if(!t&&u&&!a&&!v){let e=setTimeout(()=>{p(!1),N(!0)},1e3);return()=>clearTimeout(e)}},[t,u,a,p,v]),(0,n.jsx)(g.Provider,{value:{isStreaming:t,isOpen:u,setIsOpen:p,duration:h},children:(0,n.jsx)(x.zF,{className:(0,l.cn)("not-prose mb-4",s),onOpenChange:e=>{p(e)},open:u,...c,children:d})})}),N=(0,f.memo)(e=>{let{className:s,title:t="Reasoning",children:r,...a}=e,{isStreaming:i,isOpen:o,duration:d}=j();return(0,n.jsx)(x.wy,{className:(0,l.cn)("flex items-center gap-2 text-muted-foreground text-sm",s),...a,children:null!=r?r:(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(p.Z,{className:"size-4"}),i||0===d?(0,n.jsx)("p",{children:"Thinking..."}):(0,n.jsxs)("p",{children:["Thought for ",d," seconds"]}),(0,n.jsx)(h.Z,{className:(0,l.cn)("size-4 text-muted-foreground transition-transform",o?"rotate-180":"rotate-0")})]})})}),b=(0,f.memo)(e=>{let{className:s,children:t,...r}=e;return(0,n.jsx)(x.Fw,{className:(0,l.cn)("mt-4 text-sm","data-[state=closed]:fade-out-0 data-[state=closed]:slide-out-to-top-2 data-[state=open]:slide-in-from-top-2 text-popover-foreground outline-none data-[state=closed]:animate-out data-[state=open]:animate-in",s),...r,children:(0,n.jsx)(u.H,{className:"grid gap-2",children:t})})});v.displayName="Reasoning",N.displayName="ReasoningTrigger",b.displayName="ReasoningContent";var y=t(55455);let w=e=>{let{className:s,...t}=e;return(0,n.jsx)(x.zF,{className:(0,l.cn)("not-prose mb-4 text-primary text-xs",s),...t})},k=e=>{let{className:s,count:t,children:l,...r}=e;return(0,n.jsx)(x.wy,{className:"flex items-center gap-2",...r,children:null!=l?l:(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("p",{className:"font-medium",children:["Used ",t," sources"]}),(0,n.jsx)(h.Z,{className:"h-4 w-4"})]})})},C=e=>{let{className:s,...t}=e;return(0,n.jsx)(x.Fw,{className:(0,l.cn)("mt-3 flex w-fit flex-col gap-2","data-[state=closed]:fade-out-0 data-[state=closed]:slide-out-to-top-2 data-[state=open]:slide-in-from-top-2 outline-none data-[state=closed]:animate-out data-[state=open]:animate-in",s),...t})},Z=e=>{let{href:s,title:t,children:l,...r}=e;return(0,n.jsx)("a",{className:"flex items-center gap-2",href:s,rel:"noreferrer",target:"_blank",...r,children:null!=l?l:(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(y.Z,{className:"h-4 w-4"}),(0,n.jsx)("span",{className:"block font-medium",children:t})]})})};var z=t(52636),F=t(78867),T=t(33145),_=t(77992);function L(e){let{messages:s,status:t="idle",className:i,showActions:o=!0,onRegenerate:m,onAddToolResult:x,UntypedToolPartComponent:p,addToContext:h,writeAccess:f=!0,config:g}=e,{toast:j}=(0,_.pm)();return(0,n.jsx)(n.Fragment,{children:null==s?void 0:s.map((e,y)=>{let _=e.metadata;return s.length,(0,n.jsx)(r,{className:(0,l.cn)("assistant"===e.role&&((null==g?void 0:g.customAssistantClassnames)?null==g?void 0:g.customAssistantClassnames:""),0===y&&((null==g?void 0:g.marginTopFirstMessage)?null==g?void 0:g.marginTopFirstMessage:"mt-12"),i),from:e.role,children:(0,n.jsxs)(a,{children:[e.parts.map((s,l)=>{if("step-start"===s.type)return null;if("text"===s.type)return(0,n.jsx)("div",{children:(0,n.jsx)(u.H,{className:"chat-response-container",children:s.text})},"".concat(e.id,"-").concat(l));if("tool-askForConfirmation"===s.type&&x){let e=s.toolCallId;switch(s.state){case"input-streaming":return(0,n.jsx)("div",{children:"Loading confirmation request..."},e);case"input-available":return(0,n.jsxs)("div",{children:[s.input.message,(0,n.jsxs)("div",{children:[(0,n.jsx)("button",{onClick:()=>x({tool:"askForConfirmation",toolCallId:e,output:"Yes, confirmed"}),children:"Yes"}),(0,n.jsx)("button",{onClick:()=>x({tool:"askForConfirmation",toolCallId:e,output:"No, denied"}),children:"No"})]})]},e);case"output-available":return(0,n.jsxs)("div",{children:["Tool call allowed: ",s.output]},e);case"output-error":return(0,n.jsxs)("div",{children:["Error: ",s.errorText]},e)}}if((s.type.startsWith("tool-")||"dynamic-tool"===s.type)&&p&&h){let e=s.toolCallId;return(0,n.jsx)(p,{untypedToolPart:s,callId:e,addToContext:h},e)}if("file"===s.type){var r;if(null===(r=s.mediaType)||void 0===r?void 0:r.startsWith("image/"))return(0,n.jsx)(T.default,{src:s.url,width:300,height:300,alt:"Generated image"},"".concat(e.id,"-").concat(l))}return"source-url"===s.type?(0,n.jsxs)(w,{children:[(0,n.jsx)(k,{count:e.parts.filter(e=>"source-url"===e.type).length}),(0,n.jsx)(C,{children:e.parts.map((s,t)=>{if("source-url"===s.type)return(0,n.jsx)(Z,{href:s.url,title:s.title},"".concat(e.id,"-").concat(t))})},"".concat(e.id))]},"".concat(e.id,"-").concat(l)):"reasoning"===s.type?(0,n.jsxs)(v,{className:"w-full",isStreaming:"streaming"===t,children:[(0,n.jsx)(N,{}),(0,n.jsx)(b,{children:s.text})]},"".concat(e.id,"-").concat(l)):null}),o&&"assistant"===e.role&&(0,n.jsxs)(d,{className:"mt-2",children:[m&&(0,n.jsx)(c,{onClick:()=>m(),label:"Retry",disabled:!f,children:(0,n.jsx)(z.Z,{className:"size-3"})}),(0,n.jsx)(c,{onClick:()=>{navigator.clipboard.writeText(e.parts.map(e=>(null==e?void 0:e.text)||"").join("\n")),j({title:"Copied message",description:"The message was copied to your clipboard."})},label:"Copy",children:(0,n.jsx)(F.Z,{className:"size-3"})}),(null==_?void 0:_.totalTokens)&&(0,n.jsxs)("small",{className:"text-muted-foreground",children:[Intl.NumberFormat("en-US").format(null==_?void 0:_.totalTokens)," tokens"]})]})]})},e.id)})})}},65613:function(e,s,t){t.d(s,{Cd:function(){return d},X:function(){return c},bZ:function(){return o}});var n=t(57437),l=t(90535),r=t(2265),a=t(94508);let i=(0,l.j)("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive",info:"border-info/50 text-info dark:border-info [&>svg]:text-info"}},defaultVariants:{variant:"default"}}),o=r.forwardRef((e,s)=>{let{className:t,variant:l,...r}=e;return(0,n.jsx)("div",{ref:s,role:"alert",className:(0,a.cn)(i({variant:l}),t),...r})});o.displayName="Alert";let d=r.forwardRef((e,s)=>{let{className:t,...l}=e;return(0,n.jsx)("h5",{ref:s,className:(0,a.cn)("mb-1 font-medium leading-none tracking-tight",t),...l})});d.displayName="AlertTitle";let c=r.forwardRef((e,s)=>{let{className:t,...l}=e;return(0,n.jsx)("div",{ref:s,className:(0,a.cn)("text-sm [&_p]:leading-relaxed",t),...l})});c.displayName="AlertDescription"},74928:function(e,s,t){t.d(s,{Fw:function(){return a},wy:function(){return r},zF:function(){return l}});var n=t(88985);let l=n.fC,r=n.wy,a=n.Fw},12339:function(e,s,t){t.d(s,{SP:function(){return d},dr:function(){return o},mQ:function(){return i},nU:function(){return c}});var n=t(57437),l=t(20271),r=t(2265),a=t(94508);let i=l.fC,o=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,n.jsx)(l.aV,{ref:s,className:(0,a.cn)("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",t),...r})});o.displayName=l.aV.displayName;let d=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,n.jsx)(l.xz,{ref:s,className:(0,a.cn)("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",t),...r})});d.displayName=l.xz.displayName;let c=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,n.jsx)(l.VY,{ref:s,className:(0,a.cn)("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",t),...r})});c.displayName=l.VY.displayName},78361:function(e,s,t){t.d(s,{jF:function(){return R},jU:function(){return W},ZP:function(){return O},NF:function(){return U}});var n=t(57437),l=t(2265),r=t(47632),a=t(1109);t(46693),t(51832);var i=t(6374),o=t(44045);let d=async e=>{var s;if(!e.backend)throw Error("No backend set.");let{callbacks:t,maxNumberOfFiles:n,uppyOptions:l}=e||{},{uploadSuccess:o}=t||{},{allowedFileTypes:d,id:c}=l||{},u=await (0,i.LP)(),m=new r.Z({autoProceed:!0,debug:!1,id:c||"uppy",restrictions:{maxNumberOfFiles:n||5,allowedFileTypes:d||[".heic",".jpg",".jpeg",".png",".webp",".svg"]}}).use(a.Z,{id:"Exulu",endpoint:e.backend,headers:{Authorization:"Bearer ".concat(u),Session:null!==(s=localStorage.getItem("session"))&&void 0!==s?s:""}}).on("file-added",async e=>{console.debug("added",e)}).on("upload-error",(e,s)=>{(null==e?void 0:e.id)&&(m.removeFile(null==e?void 0:e.id),console.error("error",s))}).on("upload-success",(e,s)=>{s.uploadURL&&o&&(console.log("response",s),o({file:e,key:s.uploadURL.split("/").pop()||"",url:s.uploadURL}))});return m};var c=function(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],t=(0,l.useContext)(o.E),[n,r]=(0,l.useState)(void 0);return(0,l.useEffect)(()=>((async()=>{r(await d({...e,backend:(null==t?void 0:t.backend)||""}))})(),()=>{n&&(n.destroy(),r(void 0))}),[...s]),n},u=t(80007),m=t(92735),x=t(88964),p=t(30044),h=t(92451),f=t(10407),g=t(48736),j=t(53113),v=t(69658),N=t(99397),b=t(32489),y=t(15001),w=t(62869),k=t(26110),C=t(19378),Z=t(78298),z=t(11713),F=t(21770),T=t(95186),_=t(20653),L=t(66070),S=t(93022);function R(e){let{s3key:s,children:t}=e,{data:r,isLoading:a,error:o,refetch:d}=(0,z.a)({queryKey:["fileObject",s],queryFn:async()=>s?await i.QZ.object(s):null,enabled:null!=s});return((0,l.useEffect)(()=>{s&&d()},[s]),s)?(0,n.jsxs)(L.Zb,{children:[(0,n.jsx)(L.Ol,{className:"pb-3",children:(0,n.jsx)(L.ll,{className:"text-sm truncate",children:s.split("_EXULU_").pop()})}),(0,n.jsxs)(L.aY,{className:"pt-0",children:[a&&(0,n.jsxs)("div",{className:"space-y-2",children:[(0,n.jsx)(S.O,{className:"h-4 w-full"}),(0,n.jsx)(S.O,{className:"h-4 w-2/3"})]}),!a&&r&&(0,n.jsxs)("div",{className:"space-y-2",children:[(0,n.jsxs)("div",{className:"flex items-center justify-between text-xs text-muted-foreground",children:[(0,n.jsx)("span",{className:"capitalize",children:null==r?void 0:r.ContentType.split("/").pop()}),(0,n.jsxs)("span",{children:[((null==r?void 0:r.ContentLength)/1024/1024).toFixed(2)," MB"]})]}),(0,n.jsxs)("div",{className:"flex items-center justify-between text-xs text-muted-foreground",children:[(0,n.jsxs)("span",{children:["Last modified: ",new Date(null==r?void 0:r.LastModified).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"})]}),(0,n.jsxs)(w.z,{variant:"secondary",size:"sm",type:"button",className:"h-7 px-2",onClick:()=>{i.QZ.download(s).then(async e=>{console.log("res",e);let s=await e.json();console.log("res",s);let t=s.url;window.open(t,"_blank")})},children:[(0,n.jsx)("span",{className:"mr-1 text-xs",children:"View"}),(0,n.jsx)(m.Z,{className:"h-3 w-3"})]})]})]}),!a&&o&&(0,n.jsx)("p",{className:"text-xs text-muted-foreground",children:o.message}),t]})]}):(0,n.jsx)(L.Zb,{children:(0,n.jsxs)(L.aY,{className:"p-3 flex",children:[(0,n.jsx)("p",{className:"text-sm text-muted-foreground m-auto",children:"No file selected"}),t]})})}function O(e){let{id:s,allowedFileTypes:t,dependencies:r,onConfirm:a,selectionLimit:i,buttonText:o}=e,[d,c]=(0,l.useState)(!1);return(0,n.jsxs)(k.Vq,{open:d,onOpenChange:c,children:[(0,n.jsx)(k.hg,{asChild:!0,children:(0,n.jsxs)(w.z,{variant:"outline",children:[o&&(0,n.jsx)("span",{className:"mr-2",children:o}),(0,n.jsx)(x.Z,{className:"h-4 w-4"})]})}),(0,n.jsxs)(k.cZ,{className:"sm:max-w-[900px]",children:[(0,n.jsxs)(k.fK,{children:[(0,n.jsx)(k.$N,{children:"File Gallery"}),(0,n.jsx)(k.Be,{children:"Browse your previously uploaded files or upload new ones."})]}),(0,n.jsx)(E,{id:s,allowedFileTypes:t,dependencies:r,selectionLimit:i,onConfirm:e=>{a(e),c(!1)}})]})]})}let E=e=>{var s,t;let{id:r,allowedFileTypes:a,dependencies:d,onConfirm:m,selectionLimit:x}=e;a||(a=[".png",".jpg",".jpeg",".gif",".webp",".pdf",".docx",".xlsx",".xls",".csv",".pptx",".ppt",".mp3",".wav",".m4a",".mp4",".mpeg",".mp4",".m4a",".mp3",".mpeg",".wav"]);let[g,j]=(0,l.useState)(void 0),[v,N]=(0,l.useState)(void 0),[b,y]=(0,l.useState)(void 0),k=(0,l.useContext)(o.E),[L,R]=(0,l.useState)([]),O=e=>{if(L.includes(e)){R(L.filter(s=>s!==e));return}if(1===x){R([e]);return}L.length>=x||R([...L,e])},E=(0,F.D)({mutationFn:async e=>{let{key:s}=e;await i.QZ.delete(s),I()}}),{data:P,isLoading:U,error:A,refetch:I}=(0,z.a)({queryKey:["filesQuery",g,b],staleTime:3e4,queryFn:async()=>i.QZ.list({search:g,continuationToken:b})});console.log("!! data !!",P);let{theme:q}=(0,Z.F)(),K=c({backend:(null==k?void 0:k.backend)||"",uppyOptions:{id:r,allowedFileTypes:a},callbacks:{uploadSuccess:async e=>{console.log("data",e)}},maxNumberOfFiles:10},d);return((0,l.useEffect)(()=>{I()},[g,b]),K)?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mt-4",children:[(0,n.jsxs)("div",{className:"border rounded-lg p-4",children:[(0,n.jsx)("h3",{className:"text-sm font-medium mb-3",children:"Previously Uploaded Files"}),(0,n.jsx)(T.I,{placeholder:"Search files...",value:g,onChange:e=>j(e.target.value),className:"mb-3"}),(0,n.jsxs)("div",{className:"flex items-center justify-between text-xs text-muted-foreground pb-2",children:[(0,n.jsxs)("span",{children:[L.length," / ",x," files selected"]}),(0,n.jsxs)("span",{children:["Allowed file types: ",null==a?void 0:a.map(e=>e).join(", ")]})]}),(0,n.jsxs)(C.x,{children:[U&&(0,n.jsxs)("div",{className:"flex items-center justify-center h-full w-full grid grid-cols-2 sm:grid-cols-3 gap-3",children:[(0,n.jsx)(S.O,{className:"h-[120px] w-full"}),(0,n.jsx)(S.O,{className:"h-[120px] w-full"}),(0,n.jsx)(S.O,{className:"h-[120px] w-full"}),(0,n.jsx)(S.O,{className:"h-[120px] w-full"}),(0,n.jsx)(S.O,{className:"h-[120px] w-full"}),(0,n.jsx)(S.O,{className:"h-[120px] w-full"}),(0,n.jsx)(S.O,{className:"h-[120px] w-full"}),(0,n.jsx)(S.O,{className:"h-[120px] w-full"}),(0,n.jsx)(S.O,{className:"h-[120px] w-full"})]}),(0,n.jsxs)("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-3",children:[!U&&!(null==P?void 0:null===(s=P.Contents)||void 0===s?void 0:s.length)&&(0,n.jsxs)("div",{className:"col-span-full flex flex-col items-center justify-center py-12 text-center",children:[(0,n.jsx)(p.Z,{className:"h-12 w-12 text-muted-foreground/50 mb-3"}),(0,n.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"Nothing to see here... yet!"}),(0,n.jsx)("p",{className:"text-xs text-muted-foreground/75 mt-1",children:"Upload some files to get started"})]}),null==P?void 0:null===(t=P.Contents)||void 0===t?void 0:t.map(e=>(0,n.jsx)(W,{s3Key:e.Key,onSelect:O,active:L.some(s=>s===e.Key),onRemove:()=>{E.mutate({key:e.Key})},disabled:!!a&&!(null==a?void 0:a.some(s=>e.Key.endsWith(s)))}))]}),(0,n.jsx)("div",{className:"flex items-center space-x-6 lg:space-x-8 pt-3",children:(0,n.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,n.jsxs)(w.z,{variant:"outline",className:"hidden size-8 p-0 lg:flex",onClick:()=>{y(void 0)},disabled:!b||U,children:[(0,n.jsx)("span",{className:"sr-only",children:"Go to first page"}),(0,n.jsx)(_.kRt,{className:"size-4"})]}),(0,n.jsxs)(w.z,{variant:"outline",className:"size-8 p-0",onClick:()=>{y(v)},disabled:!b||U,children:[(0,n.jsx)("span",{className:"sr-only",children:"Go to previous page"}),(0,n.jsx)(h.Z,{className:"size-4"})]}),(0,n.jsxs)(w.z,{variant:"outline",className:"size-8 p-0",onClick:()=>{N(b),y(null==P?void 0:P.NextContinuationToken)},disabled:!(null==P?void 0:P.NextContinuationToken)||U,children:[(0,n.jsx)("span",{className:"sr-only",children:"Go to next page"}),(0,n.jsx)(f.Z,{className:"size-4"})]})]})})]})]}),(0,n.jsxs)("div",{className:"border rounded-lg p-4",children:[(0,n.jsx)("h3",{className:"text-sm font-medium mb-3",children:"Upload New Files"}),(0,n.jsx)(u.A,{uppy:K,theme:"dark"===q?"dark":"light"})]})]}),(0,n.jsx)("div",{className:"flex justify-end",children:(0,n.jsx)(w.z,{variant:"outline",onClick:()=>{m(L),R([])},children:"Confirm"})})]}):null},W=e=>{let{s3Key:s,onSelect:t,onRemove:l,active:r,disabled:a,addToContext:o}=e;return(0,n.jsxs)("div",{className:"".concat(a?"opacity-50":""," group relative rounded-lg p-2 hover:bg-muted transition-colors cursor-pointer ").concat(r?"border border-purple-500":"border"),onClick:()=>{!a&&t&&t(s)},children:[(0,n.jsx)("div",{className:"aspect-square relative mb-2 bg-muted/50 rounded-md overflow-hidden flex items-center justify-center",children:s&&(s.toLowerCase().endsWith("jpg")||s.toLowerCase().endsWith("jpeg")||s.toLowerCase().endsWith("png")||s.toLowerCase().endsWith("svg"))?(0,n.jsx)(A,{fileKey:s}):(0,n.jsxs)("div",{className:"flex flex-col items-center justify-center h-full",children:[s?s.toLowerCase().endsWith("jpg")||s.toLowerCase().endsWith("jpeg")||s.toLowerCase().endsWith("png")||s.toLowerCase().endsWith("svg")?(0,n.jsx)(j.Z,{className:"h-6 w-6 text-blue-500"}):s.endsWith("pdf")?(0,n.jsx)(v.Z,{className:"h-6 w-6 text-red-500"}):s.endsWith("xls")||s.endsWith("xlsx")||s.endsWith("csv")?(0,n.jsx)(g.Z,{className:"h-6 w-6 text-green-500"}):s.endsWith("ppt")||s.endsWith("pptx")?(0,n.jsx)(g.Z,{className:"h-6 w-6 text-orange-500"}):(0,n.jsx)(g.Z,{className:"h-6 w-6 text-gray-500"}):(0,n.jsx)(g.Z,{className:"h-6 w-6 text-gray-500"}),(0,n.jsx)("span",{className:"text-xs text-muted-foreground mt-1 text-center",children:s?s.split("_EXULU_").pop():s})]})}),(0,n.jsx)("p",{className:"text-xs truncate",children:s?s.split("_EXULU_").pop():s}),(0,n.jsxs)("div",{className:"opacity-0 group-hover:opacity-100 flex absolute top-1 right-1",children:[o&&(0,n.jsxs)(w.z,{variant:"ghost",size:"icon",type:"button",className:"h-6 w-6 bg-background/80 hover:bg-background",onClick:()=>{o(s)},children:[(0,n.jsx)(N.Z,{className:"h-3 w-3"}),(0,n.jsx)("span",{className:"sr-only",children:"Add"})]}),(0,n.jsxs)(w.z,{variant:"ghost",size:"icon",type:"button",className:"h-6 w-6 bg-background/80 hover:bg-background",onClick:()=>{i.QZ.download(s).then(async e=>{console.log("res",e);let s=await e.json();console.log("res",s);let t=s.url;window.open(t,"_blank")})},children:[(0,n.jsx)(m.Z,{className:"h-3 w-3"}),(0,n.jsx)("span",{className:"sr-only",children:"View"})]}),l&&(0,n.jsxs)(w.z,{onClick:e=>{e.stopPropagation(),l(s)},variant:"ghost",type:"button",size:"icon",className:"h-6 w-6 opacity-0 group-hover:opacity-100 bg-background/80 hover:bg-background ml-1",children:[(0,n.jsx)(b.Z,{className:"h-3 w-3"}),(0,n.jsx)("span",{className:"sr-only",children:"Remove"})]})]})]},s)},P={},U=async e=>{if(P[e]){if(!(P[e].expiresAt<Date.now()))return P[e].url;delete P[e]}let s=await i.QZ.download(e),t=await s.json();return console.log("json",t),P[e]={url:t.url,expiresAt:Date.now()+6e4},t.url},A=e=>{let{fileKey:s}=e;console.log("key",s);let t=(0,z.a)({queryKey:["imageQuery",s],staleTime:3e4,queryFn:async()=>U(s)});return t.isLoading?(0,n.jsx)("div",{children:(0,n.jsx)(y.Z,{})}):t.isLoading||t.data?(0,n.jsx)("img",{src:t.data,alt:s,className:"object-cover w-full h-full"}):(0,n.jsx)("div",{children:(0,n.jsx)(p.Z,{})})}}}]);
//# sourceMappingURL=1002-a2d6d2c2b4a8d321.js.map