(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9727],{97044:function(e,s,t){Promise.resolve().then(t.bind(t,831))},831:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return A},dynamic:function(){return P}});var a=t(57437),l=t(2265),r=t(99376),i=t(7211),n=t(12199),c=t(13832),d=t(64972),o=t(32660),h=t(82023),u=t(33276),m=t(15863),x=t(83229),v=t(48736),f=t(45554),p=t(99397),j=t(88893),g=t(32489),N=t(65613),y=t(37099),b=t(62869),k=t(95186),w=t(26815),C=t(76818),Z=t(66070),_=t(35974),S=t(93022),E=t(77992),z=t(27689),R=t(73247),T=t(26110),M=t(19060),q=t(19378);function I(e){var s;let{open:t,onClose:r,onSelect:n,excludeIds:c=[]}=e,[d,o]=(0,l.useState)(""),[h,u]=(0,l.useState)([]),{loading:m,data:x}=(0,i.aM)(z.RV,{variables:{page:1,limit:100,filters:d?[{AND:[{name:{contains:d}},{eval_set_id:{eq:null}}]}]:[{eval_set_id:{eq:null}}]},skip:!t});(0,l.useEffect)(()=>{t||(u([]),o(""))},[t]);let v=((null==x?void 0:null===(s=x.test_casesPagination)||void 0===s?void 0:s.items)||[]).filter(e=>!c.includes(e.id)),f=e=>{u(s=>s.includes(e)?s.filter(s=>s!==e):[...s,e])};return(0,a.jsx)(T.Vq,{open:t,onOpenChange:r,children:(0,a.jsxs)(T.cZ,{className:"max-w-3xl max-h-[80vh] flex flex-col",children:[(0,a.jsxs)(T.fK,{children:[(0,a.jsx)(T.$N,{children:"Add Test Cases"}),(0,a.jsx)(T.Be,{children:"Select test cases to add to this eval set. Already added test cases are hidden."})]}),(0,a.jsxs)("div",{className:"space-y-4 flex-1 overflow-hidden flex flex-col",children:[(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(R.Z,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground"}),(0,a.jsx)(k.I,{placeholder:"Search test cases by name...",value:d,onChange:e=>o(e.target.value),className:"pl-9"})]}),v.length>0&&(0,a.jsxs)("div",{className:"flex items-center gap-2 px-1",children:[(0,a.jsx)(M.X,{id:"select-all-test-cases",checked:h.length===v.length&&v.length>0,onCheckedChange:()=>{h.length===v.length?u([]):u(v.map(e=>e.id))}}),(0,a.jsxs)(w._,{htmlFor:"select-all-test-cases",className:"text-sm text-muted-foreground",children:["Select all (",h.length," selected)"]})]}),(0,a.jsx)(q.x,{className:"flex-1 border rounded-lg",children:(0,a.jsx)("div",{children:m?Array.from({length:3}).map((e,s)=>(0,a.jsx)(S.O,{className:"h-10 w-full"},s)):0===v.length?(0,a.jsx)("div",{className:"text-center py-12 text-muted-foreground mx-5",children:d?"No test cases found matching your search.":"No test cases available to add (note: you can only add test cases that are not already in an eval set, remove them from another eval set first if you want to add them to a new eval set)."}):v.map(e=>(0,a.jsxs)("div",{onClick:()=>{f(e.id)},className:"flex items-start gap-3 p-3 hover:bg-muted/50",children:[(0,a.jsx)(M.X,{checked:h.includes(e.id),id:"select-test-case-".concat(e.id),onCheckedChange:()=>f(e.id)}),(0,a.jsxs)(w._,{htmlFor:"select-test-case-".concat(e.id),className:"text-sm text-muted-foreground flex flex-col",children:[(0,a.jsx)("span",{children:e.name}),(0,a.jsx)("small",{children:e.description})]})]},e.id))})})]}),(0,a.jsxs)(T.cN,{children:[(0,a.jsx)(b.z,{variant:"outline",onClick:r,children:"Cancel"}),(0,a.jsxs)(b.z,{onClick:()=>{n(h)},disabled:0===h.length,children:["Add ",h.length," Test Case",1!==h.length?"s":""]})]})]})})}var O=t(82534);let P="force-dynamic";function A(){var e,s,t,R;let T=(0,r.useParams)(),M=(0,r.useRouter)(),{user:q}=(0,l.useContext)(c.S),{toast:P}=(0,E.pm)(),A=T.id,[V,D]=(0,l.useState)(""),[F,B]=(0,l.useState)(""),[L,X]=(0,l.useState)([]),[Y,$]=(0,l.useState)(!1),[W,H]=(0,l.useState)(!1),[K,G]=(0,l.useState)(null),[J,Q]=(0,l.useState)(null),U=q.super_admin||(null===(e=q.role)||void 0===e?void 0:e.evals)==="read"||(null===(s=q.role)||void 0===s?void 0:s.evals)==="write",ee=q.super_admin||(null===(t=q.role)||void 0===t?void 0:t.evals)==="write",{loading:es,data:et,refetch:ea}=(0,i.aM)(z.iA,{variables:{id:A},skip:!A,onCompleted:e=>{(null==e?void 0:e.eval_setById)&&(D(e.eval_setById.name),B(e.eval_setById.description||""))}}),{data:el,refetch:er}=(0,i.aM)(z.RV,{variables:{page:1,limit:500,filters:[{eval_set_id:{eq:A}}]}}),[ei,{loading:en}]=(0,n.D)(z.vP,{onCompleted:()=>{P({title:"Eval set updated",description:"The eval set has been successfully updated."}),ea()},onError:e=>{P({title:"Failed to update eval set",description:e.message,variant:"destructive"})}}),ec=e=>{G(e)},[ed,{loading:eo}]=(0,n.D)(z.Mh,{onError:e=>{P({title:"Failed to update test case",description:e.message,variant:"destructive"})}});if(!U)return(0,a.jsx)("div",{className:"flex h-full flex-1 flex-col space-y-8 p-8",children:(0,a.jsxs)(N.bZ,{variant:"destructive",children:[(0,a.jsx)(d.Z,{className:"h-4 w-4"}),(0,a.jsx)(N.X,{children:"You don't have permission to access Eval Sets. Contact your administrator to request access."})]})});if(es)return(0,a.jsxs)("div",{className:"flex h-full flex-1 flex-col space-y-8 p-8",children:[(0,a.jsx)(S.O,{className:"h-8 w-64"}),(0,a.jsx)(S.O,{className:"h-64 w-full"})]});let eh=(null==el?void 0:null===(R=el.test_casesPagination)||void 0===R?void 0:R.items)||[];return(0,a.jsxs)("div",{className:"flex h-full flex-1 flex-col space-y-8 p-8",children:[(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("div",{className:"absolute inset-0 bg-primary/5 rounded-lg blur-xl"}),(0,a.jsxs)("div",{className:"relative flex items-center justify-between p-6 border rounded-lg bg-card/50 backdrop-blur-sm",children:[(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsx)(b.z,{variant:"ghost",size:"icon",onClick:()=>M.push("/evals"),children:(0,a.jsx)(o.Z,{className:"h-4 w-4"})}),(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("div",{className:"p-2 rounded-lg bg-primary",children:(0,a.jsx)(h.Z,{className:"h-5 w-5 text-primary-foreground"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-2xl font-bold tracking-tight",children:"Edit Eval Set"}),(0,a.jsx)("p",{className:"text-muted-foreground",children:"Configure test cases for this evaluation set."})]})]})]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsxs)(b.z,{variant:"outline",onClick:()=>M.push("/evals/".concat(A,"/runs")),children:[(0,a.jsx)(u.Z,{className:"mr-2 h-4 w-4"}),"View Runs"]}),ee&&(0,a.jsxs)(b.z,{onClick:()=>{if(!V.trim()){P({title:"Validation error",description:"Name is required.",variant:"destructive"});return}if(L.length>500){P({title:"Validation error",description:"Maximum 500 test cases allowed per eval set.",variant:"destructive"});return}ei({variables:{id:A,data:{name:V.trim(),description:F.trim()||null}}})},disabled:en,children:[en?(0,a.jsx)(m.Z,{className:"mr-2 h-4 w-4 animate-spin"}):(0,a.jsx)(x.Z,{className:"mr-2 h-4 w-4"}),"Save Changes"]})]})]})]}),(0,a.jsxs)(Z.Zb,{className:"shadow-lg",children:[(0,a.jsx)(Z.Ol,{className:"border-b bg-accent/50",children:(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("div",{className:"p-2 rounded-lg bg-primary/10",children:(0,a.jsx)(v.Z,{className:"h-4 w-4 text-primary"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)(Z.ll,{children:"Basic Information"}),(0,a.jsx)(Z.SZ,{children:"Edit the name and description of this eval set."})]})]})}),(0,a.jsxs)(Z.aY,{className:"space-y-4 pt-6",children:[(0,a.jsxs)("div",{className:"grid gap-2",children:[(0,a.jsx)(w._,{htmlFor:"name",className:"text-sm font-semibold",children:"Name *"}),(0,a.jsx)(k.I,{id:"name",placeholder:"Eval set name",value:V,onChange:e=>D(e.target.value),disabled:!ee})]}),(0,a.jsxs)("div",{className:"grid gap-2",children:[(0,a.jsx)(w._,{htmlFor:"description",className:"text-sm font-semibold",children:"Description"}),(0,a.jsx)(C.g,{id:"description",placeholder:"Describe what this eval set tests...",value:F,onChange:e=>B(e.target.value),disabled:!ee,rows:3})]})]})]}),(0,a.jsxs)(Z.Zb,{className:"shadow-lg",children:[(0,a.jsx)(Z.Ol,{className:"border-b bg-accent/50",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("div",{className:"p-2 rounded-lg bg-primary/10",children:(0,a.jsx)(f.Z,{className:"h-4 w-4 text-primary"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)(Z.ll,{children:"Test Cases"}),(0,a.jsxs)(Z.SZ,{children:["Add up to 500 test cases to this eval set."," ",(0,a.jsxs)(_.C,{variant:"secondary",className:"ml-1",children:[eh.length,"/500"]})]})]})]}),ee&&(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsxs)(b.z,{variant:"outline",size:"sm",onClick:()=>H(!0),children:[(0,a.jsx)(p.Z,{className:"mr-2 h-4 w-4"}),"Create New"]}),(0,a.jsxs)(b.z,{variant:"secondary",size:"sm",onClick:()=>$(!0),disabled:L.length>=500,children:[(0,a.jsx)(p.Z,{className:"mr-2 h-4 w-4"}),"Add Existing"]})]})]})}),(0,a.jsx)(Z.aY,{className:"pt-6",children:0===eh.length?(0,a.jsxs)("div",{className:"flex flex-col items-center justify-center py-16 text-center",children:[(0,a.jsx)("div",{className:"p-4 rounded-full bg-primary/10 mb-4",children:(0,a.jsx)(f.Z,{className:"h-8 w-8 text-primary"})}),(0,a.jsx)("h3",{className:"text-lg font-semibold mb-2",children:"No test cases yet"}),(0,a.jsx)("p",{className:"text-muted-foreground max-w-sm",children:'Click "Create New" or "Add Existing" to start building your evaluation set.'})]}):(0,a.jsx)("div",{className:"space-y-3",children:eh.map(e=>(0,a.jsxs)("div",{className:"group relative flex items-center justify-between p-4 border rounded-lg transition-all hover:shadow-md hover:border-primary/50 hover:scale-[1.01] hover:bg-accent/30",children:[(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("div",{className:"p-1.5 rounded bg-primary/10",children:(0,a.jsx)(v.Z,{className:"h-3.5 w-3.5 text-primary"})}),(0,a.jsx)("span",{className:"font-semibold",children:e.name})]}),e.description&&(0,a.jsx)("p",{className:"text-sm text-muted-foreground mt-2 ml-8",children:e.description})]}),ee&&(0,a.jsxs)("div",{className:"flex gap-1 opacity-0 group-hover:opacity-100 transition-opacity",children:[(0,a.jsxs)(b.z,{variant:"ghost",size:"sm",onClick:()=>{Q(e),H(!0)},className:"hover:bg-primary/10",children:[(0,a.jsx)(j.Z,{className:"mr-1 h-3.5 w-3.5"}),"Edit"]}),(0,a.jsxs)(b.z,{variant:"ghost",size:"sm",onClick:()=>ec(e.id),className:"hover:bg-destructive/10 hover:text-destructive",children:[(0,a.jsx)(g.Z,{className:"mr-1 h-3.5 w-3.5"}),"Remove"]})]})]},e.id))})})]}),(0,a.jsx)(I,{open:Y,onClose:()=>$(!1),onSelect:e=>{let s=Array.from(new Set([...L,...e]));if(s.length>500){P({title:"Too many test cases",description:"Maximum 500 test cases allowed per eval set.",variant:"destructive"});return}for(let e of(console.log("newTestCases",s),s))ed({variables:{id:e,data:{eval_set_id:A}}});er(),$(!1)},excludeIds:L}),(0,a.jsx)(O.F,{open:W,onClose:()=>H(!1),evalSetId:A,onSuccess:()=>{H(!1),er(),ea()},testCase:J}),(0,a.jsx)(y.aR,{open:!!K,onOpenChange:e=>!e&&G(null),children:(0,a.jsxs)(y._T,{children:[(0,a.jsxs)(y.fY,{children:[(0,a.jsx)(y.f$,{children:"Remove test case from eval set?"}),(0,a.jsx)(y.yT,{children:"This will remove the test case from this eval set. The test case itself will not be deleted and can be added back later."})]}),(0,a.jsxs)(y.xo,{children:[(0,a.jsx)(y.le,{children:"Cancel"}),(0,a.jsx)(y.OL,{onClick:()=>{K&&ed({variables:{id:K,data:{eval_set_id:null}},onCompleted:()=>{P({title:"Test case removed",description:"The test case has been removed from this eval set."}),er(),G(null)}})},children:"Remove"})]})]})})]})}},19060:function(e,s,t){"use strict";t.d(s,{X:function(){return c}});var a=t(57437),l=t(9270),r=t(30401),i=t(2265),n=t(94508);let c=i.forwardRef((e,s)=>{let{className:t,...i}=e;return(0,a.jsx)(l.fC,{ref:s,className:(0,n.cn)("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",t),...i,children:(0,a.jsx)(l.z$,{className:(0,n.cn)("flex items-center justify-center text-current"),children:(0,a.jsx)(r.Z,{className:"size-4"})})})});c.displayName=l.fC.displayName},45554:function(e,s,t){"use strict";t.d(s,{Z:function(){return a}});let a=(0,t(39763).Z)("ListChecks",[["path",{d:"m3 17 2 2 4-4",key:"1jhpwq"}],["path",{d:"m3 7 2 2 4-4",key:"1obspn"}],["path",{d:"M13 6h8",key:"15sg57"}],["path",{d:"M13 12h8",key:"h98zly"}],["path",{d:"M13 18h8",key:"oe0vm4"}]])},88893:function(e,s,t){"use strict";t.d(s,{Z:function(){return a}});let a=(0,t(39763).Z)("Pen",[["path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z",key:"5qss01"}]])},33276:function(e,s,t){"use strict";t.d(s,{Z:function(){return a}});let a=(0,t(39763).Z)("Play",[["polygon",{points:"5 3 19 12 5 21 5 3",key:"191637"}]])},83229:function(e,s,t){"use strict";t.d(s,{Z:function(){return a}});let a=(0,t(39763).Z)("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]])},73247:function(e,s,t){"use strict";t.d(s,{Z:function(){return a}});let a=(0,t(39763).Z)("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]])},9270:function(e,s,t){"use strict";t.d(s,{fC:function(){return y},z$:function(){return k}});var a=t(2265),l=t(98575),r=t(73966),i=t(6741),n=t(80886),c=t(6718),d=t(90420),o=t(71599),h=t(66840),u=t(57437),m="Checkbox",[x,v]=(0,r.b)(m),[f,p]=x(m);function j(e){let{__scopeCheckbox:s,checked:t,children:l,defaultChecked:r,disabled:i,form:c,name:d,onCheckedChange:o,required:h,value:x="on",internal_do_not_use_render:v}=e,[p,j]=(0,n.T)({prop:t,defaultProp:null!=r&&r,onChange:o,caller:m}),[g,N]=a.useState(null),[y,b]=a.useState(null),k=a.useRef(!1),w=!g||!!c||!!g.closest("form"),C={checked:p,disabled:i,setChecked:j,control:g,setControl:N,name:d,form:c,value:x,hasConsumerStoppedPropagationRef:k,required:h,defaultChecked:!Z(r)&&r,isFormControl:w,bubbleInput:y,setBubbleInput:b};return(0,u.jsx)(f,{scope:s,...C,children:"function"==typeof v?v(C):l})}var g="CheckboxTrigger",N=a.forwardRef((e,s)=>{let{__scopeCheckbox:t,onKeyDown:r,onClick:n,...c}=e,{control:d,value:o,disabled:m,checked:x,required:v,setControl:f,setChecked:j,hasConsumerStoppedPropagationRef:N,isFormControl:y,bubbleInput:b}=p(g,t),k=(0,l.e)(s,f),w=a.useRef(x);return a.useEffect(()=>{let e=null==d?void 0:d.form;if(e){let s=()=>j(w.current);return e.addEventListener("reset",s),()=>e.removeEventListener("reset",s)}},[d,j]),(0,u.jsx)(h.WV.button,{type:"button",role:"checkbox","aria-checked":Z(x)?"mixed":x,"aria-required":v,"data-state":_(x),"data-disabled":m?"":void 0,disabled:m,value:o,...c,ref:k,onKeyDown:(0,i.M)(r,e=>{"Enter"===e.key&&e.preventDefault()}),onClick:(0,i.M)(n,e=>{j(e=>!!Z(e)||!e),b&&y&&(N.current=e.isPropagationStopped(),N.current||e.stopPropagation())})})});N.displayName=g;var y=a.forwardRef((e,s)=>{let{__scopeCheckbox:t,name:a,checked:l,defaultChecked:r,required:i,disabled:n,value:c,onCheckedChange:d,form:o,...h}=e;return(0,u.jsx)(j,{__scopeCheckbox:t,checked:l,defaultChecked:r,disabled:n,required:i,onCheckedChange:d,name:a,form:o,value:c,internal_do_not_use_render:e=>{let{isFormControl:a}=e;return(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(N,{...h,ref:s,__scopeCheckbox:t}),a&&(0,u.jsx)(C,{__scopeCheckbox:t})]})}})});y.displayName=m;var b="CheckboxIndicator",k=a.forwardRef((e,s)=>{let{__scopeCheckbox:t,forceMount:a,...l}=e,r=p(b,t);return(0,u.jsx)(o.z,{present:a||Z(r.checked)||!0===r.checked,children:(0,u.jsx)(h.WV.span,{"data-state":_(r.checked),"data-disabled":r.disabled?"":void 0,...l,ref:s,style:{pointerEvents:"none",...e.style}})})});k.displayName=b;var w="CheckboxBubbleInput",C=a.forwardRef((e,s)=>{let{__scopeCheckbox:t,...r}=e,{control:i,hasConsumerStoppedPropagationRef:n,checked:o,defaultChecked:m,required:x,disabled:v,name:f,value:j,form:g,bubbleInput:N,setBubbleInput:y}=p(w,t),b=(0,l.e)(s,y),k=(0,c.D)(o),C=(0,d.t)(i);a.useEffect(()=>{if(!N)return;let e=Object.getOwnPropertyDescriptor(window.HTMLInputElement.prototype,"checked").set,s=!n.current;if(k!==o&&e){let t=new Event("click",{bubbles:s});N.indeterminate=Z(o),e.call(N,!Z(o)&&o),N.dispatchEvent(t)}},[N,k,o,n]);let _=a.useRef(!Z(o)&&o);return(0,u.jsx)(h.WV.input,{type:"checkbox","aria-hidden":!0,defaultChecked:null!=m?m:_.current,required:x,disabled:v,name:f,value:j,form:g,...r,tabIndex:-1,ref:b,style:{...r.style,...C,position:"absolute",pointerEvents:"none",opacity:0,margin:0,transform:"translateX(-100%)"}})});function Z(e){return"indeterminate"===e}function _(e){return Z(e)?"indeterminate":e?"checked":"unchecked"}C.displayName=w}},function(e){e.O(0,[6840,329,8310,3954,9851,7629,7093,6148,847,1942,7648,7823,8068,5799,4567,605,85,4957,7398,1785,3397,9141,1713,6152,3145,428,6373,3832,1002,5978,2971,2117,1744],function(){return e(e.s=97044)}),_N_E=e.O()}]);
//# sourceMappingURL=page-b668fca1ba6993e2.js.map