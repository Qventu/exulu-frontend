"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6989],{41658:function(e,t,a){a.d(t,{PD:function(){return K},l0:function(){return q}});var o,r=a(36962),i=a(67077),s=a(92564),l=Object.defineProperty;Symbol.for("vercel.ai.error.AI_NoOutputSpecifiedError"),i.AX,Symbol.for("vercel.ai.error.AI_InvalidArgumentError"),i.AX,Symbol.for("vercel.ai.error.AI_InvalidStreamPartError"),i.AX,Symbol.for("vercel.ai.error.AI_InvalidToolInputError"),i.AX,Symbol.for("vercel.ai.error.AI_MCPClientError"),i.AX,Symbol.for("vercel.ai.error.AI_NoImageGeneratedError"),i.AX;var p="AI_NoObjectGeneratedError",n=`vercel.ai.error.${p}`,c=Symbol.for(n),d=class extends i.AX{constructor({message:e="No object generated.",cause:t,text:a,response:r,usage:i,finishReason:s}){super({name:p,message:e,cause:t}),this[o]=!0,this.text=a,this.response=r,this.usage=i,this.finishReason=s}static isInstance(e){return i.AX.hasMarker(e,n)}};o=c,Symbol.for("vercel.ai.error.AI_NoOutputGeneratedError"),i.AX,Symbol.for("vercel.ai.error.AI_NoSuchToolError"),i.AX,Symbol.for("vercel.ai.error.AI_ToolCallRepairError"),i.AX,i.AX,Symbol.for("vercel.ai.error.AI_InvalidDataContentError"),i.AX,Symbol.for("vercel.ai.error.AI_InvalidMessageRoleError"),i.AX,Symbol.for("vercel.ai.error.AI_MessageConversionError"),i.AX,Symbol.for("vercel.ai.error.AI_DownloadError"),i.AX,Symbol.for("vercel.ai.error.AI_RetryError"),i.AX;var _=s.G0([s.Z_(),s.Pp(Uint8Array),s.Pp(ArrayBuffer),s.PG(e=>{var t,a;return null!=(a=null==(t=globalThis.Buffer)?void 0:t.isBuffer(e))&&a},{message:"Must be a Buffer"})]),u=s.Vo(()=>s.G0([s.lB(),s.Z_(),s.Rx(),s.O7(),s.IM(s.Z_(),u),s.IX(u)])),y=s.IM(s.Z_(),s.IM(s.Z_(),u)),I=s.Ry({type:s.i0("text"),text:s.Z_(),providerOptions:y.optional()}),h=s.Ry({type:s.i0("image"),image:s.G0([_,s.Pp(URL)]),mediaType:s.Z_().optional(),providerOptions:y.optional()}),E=s.Ry({type:s.i0("file"),data:s.G0([_,s.Pp(URL)]),filename:s.Z_().optional(),mediaType:s.Z_(),providerOptions:y.optional()}),R=s.Ry({type:s.i0("reasoning"),text:s.Z_(),providerOptions:y.optional()}),m=s.Ry({type:s.i0("tool-call"),toolCallId:s.Z_(),toolName:s.Z_(),input:s._4(),providerOptions:y.optional(),providerExecuted:s.O7().optional()}),f=s.VK("type",[s.Ry({type:s.i0("text"),value:s.Z_()}),s.Ry({type:s.i0("json"),value:u}),s.Ry({type:s.i0("error-text"),value:s.Z_()}),s.Ry({type:s.i0("error-json"),value:u}),s.Ry({type:s.i0("content"),value:s.IX(s.G0([s.Ry({type:s.i0("text"),text:s.Z_()}),s.Ry({type:s.i0("media"),data:s.Z_(),mediaType:s.Z_()})]))})]),A=s.Ry({type:s.i0("tool-result"),toolCallId:s.Z_(),toolName:s.Z_(),output:f,providerOptions:y.optional()}),v=s.Ry({role:s.i0("system"),content:s.Z_(),providerOptions:y.optional()}),Z=s.Ry({role:s.i0("user"),content:s.G0([s.Z_(),s.IX(s.G0([I,h,E]))]),providerOptions:y.optional()}),T=s.Ry({role:s.i0("assistant"),content:s.G0([s.Z_(),s.IX(s.G0([I,E,R,m,A]))]),providerOptions:y.optional()}),b=s.Ry({role:s.i0("tool"),content:s.IX(A),providerOptions:y.optional()});s.G0([v,Z,T,b]),(0,r.bF)({prefix:"aitxt",size:24}),TransformStream;var S=s.G0([s.cf({type:s.i0("text-start"),id:s.Z_(),providerMetadata:y.optional()}),s.cf({type:s.i0("text-delta"),id:s.Z_(),delta:s.Z_(),providerMetadata:y.optional()}),s.cf({type:s.i0("text-end"),id:s.Z_(),providerMetadata:y.optional()}),s.cf({type:s.i0("error"),errorText:s.Z_()}),s.cf({type:s.i0("tool-input-start"),toolCallId:s.Z_(),toolName:s.Z_(),providerExecuted:s.O7().optional(),dynamic:s.O7().optional()}),s.cf({type:s.i0("tool-input-delta"),toolCallId:s.Z_(),inputTextDelta:s.Z_()}),s.cf({type:s.i0("tool-input-available"),toolCallId:s.Z_(),toolName:s.Z_(),input:s._4(),providerExecuted:s.O7().optional(),providerMetadata:y.optional(),dynamic:s.O7().optional()}),s.cf({type:s.i0("tool-input-error"),toolCallId:s.Z_(),toolName:s.Z_(),input:s._4(),providerExecuted:s.O7().optional(),providerMetadata:y.optional(),dynamic:s.O7().optional(),errorText:s.Z_()}),s.cf({type:s.i0("tool-output-available"),toolCallId:s.Z_(),output:s._4(),providerExecuted:s.O7().optional(),dynamic:s.O7().optional(),preliminary:s.O7().optional()}),s.cf({type:s.i0("tool-output-error"),toolCallId:s.Z_(),errorText:s.Z_(),providerExecuted:s.O7().optional(),dynamic:s.O7().optional()}),s.cf({type:s.i0("reasoning"),text:s.Z_(),providerMetadata:y.optional()}),s.cf({type:s.i0("reasoning-start"),id:s.Z_(),providerMetadata:y.optional()}),s.cf({type:s.i0("reasoning-delta"),id:s.Z_(),delta:s.Z_(),providerMetadata:y.optional()}),s.cf({type:s.i0("reasoning-end"),id:s.Z_(),providerMetadata:y.optional()}),s.cf({type:s.i0("reasoning-part-finish")}),s.cf({type:s.i0("source-url"),sourceId:s.Z_(),url:s.Z_(),title:s.Z_().optional(),providerMetadata:y.optional()}),s.cf({type:s.i0("source-document"),sourceId:s.Z_(),mediaType:s.Z_(),title:s.Z_(),filename:s.Z_().optional(),providerMetadata:y.optional()}),s.cf({type:s.i0("file"),url:s.Z_(),mediaType:s.Z_(),providerMetadata:y.optional()}),s.cf({type:s.Z_().startsWith("data-"),id:s.Z_().optional(),data:s._4(),transient:s.O7().optional()}),s.cf({type:s.i0("start-step")}),s.cf({type:s.i0("finish-step")}),s.cf({type:s.i0("start"),messageId:s.Z_().optional(),messageMetadata:s._4().optional()}),s.cf({type:s.i0("finish"),messageMetadata:s._4().optional()}),s.cf({type:s.i0("abort")}),s.cf({type:s.i0("message-metadata"),messageMetadata:s._4()})]);async function g(e){if(void 0===e)return{value:void 0,state:"undefined-input"};let t=await (0,r.NX)({text:e});return t.success?{value:t.value,state:"successful-parse"}:(t=await (0,r.NX)({text:function(e){let t=["ROOT"],a=-1,o=null;function r(e,r,i){switch(e){case'"':a=r,t.pop(),t.push(i),t.push("INSIDE_STRING");break;case"f":case"t":case"n":a=r,o=r,t.pop(),t.push(i),t.push("INSIDE_LITERAL");break;case"-":t.pop(),t.push(i),t.push("INSIDE_NUMBER");break;case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":a=r,t.pop(),t.push(i),t.push("INSIDE_NUMBER");break;case"{":a=r,t.pop(),t.push(i),t.push("INSIDE_OBJECT_START");break;case"[":a=r,t.pop(),t.push(i),t.push("INSIDE_ARRAY_START")}}function i(e,o){switch(e){case",":t.pop(),t.push("INSIDE_OBJECT_AFTER_COMMA");break;case"}":a=o,t.pop()}}function s(e,o){switch(e){case",":t.pop(),t.push("INSIDE_ARRAY_AFTER_COMMA");break;case"]":a=o,t.pop()}}for(let l=0;l<e.length;l++){let p=e[l];switch(t[t.length-1]){case"ROOT":r(p,l,"FINISH");break;case"INSIDE_OBJECT_START":switch(p){case'"':t.pop(),t.push("INSIDE_OBJECT_KEY");break;case"}":a=l,t.pop()}break;case"INSIDE_OBJECT_AFTER_COMMA":'"'===p&&(t.pop(),t.push("INSIDE_OBJECT_KEY"));break;case"INSIDE_OBJECT_KEY":'"'===p&&(t.pop(),t.push("INSIDE_OBJECT_AFTER_KEY"));break;case"INSIDE_OBJECT_AFTER_KEY":":"===p&&(t.pop(),t.push("INSIDE_OBJECT_BEFORE_VALUE"));break;case"INSIDE_OBJECT_BEFORE_VALUE":r(p,l,"INSIDE_OBJECT_AFTER_VALUE");break;case"INSIDE_OBJECT_AFTER_VALUE":i(p,l);break;case"INSIDE_STRING":switch(p){case'"':t.pop(),a=l;break;case"\\":t.push("INSIDE_STRING_ESCAPE");break;default:a=l}break;case"INSIDE_ARRAY_START":"]"===p?(a=l,t.pop()):(a=l,r(p,l,"INSIDE_ARRAY_AFTER_VALUE"));break;case"INSIDE_ARRAY_AFTER_VALUE":switch(p){case",":t.pop(),t.push("INSIDE_ARRAY_AFTER_COMMA");break;case"]":a=l,t.pop();break;default:a=l}break;case"INSIDE_ARRAY_AFTER_COMMA":r(p,l,"INSIDE_ARRAY_AFTER_VALUE");break;case"INSIDE_STRING_ESCAPE":t.pop(),a=l;break;case"INSIDE_NUMBER":switch(p){case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":a=l;break;case"e":case"E":case"-":case".":break;case",":t.pop(),"INSIDE_ARRAY_AFTER_VALUE"===t[t.length-1]&&s(p,l),"INSIDE_OBJECT_AFTER_VALUE"===t[t.length-1]&&i(p,l);break;case"}":t.pop(),"INSIDE_OBJECT_AFTER_VALUE"===t[t.length-1]&&i(p,l);break;case"]":t.pop(),"INSIDE_ARRAY_AFTER_VALUE"===t[t.length-1]&&s(p,l);break;default:t.pop()}break;case"INSIDE_LITERAL":{let r=e.substring(o,l+1);"false".startsWith(r)||"true".startsWith(r)||"null".startsWith(r)?a=l:(t.pop(),"INSIDE_OBJECT_AFTER_VALUE"===t[t.length-1]?i(p,l):"INSIDE_ARRAY_AFTER_VALUE"===t[t.length-1]&&s(p,l))}}}let l=e.slice(0,a+1);for(let a=t.length-1;a>=0;a--)switch(t[a]){case"INSIDE_STRING":l+='"';break;case"INSIDE_OBJECT_KEY":case"INSIDE_OBJECT_AFTER_KEY":case"INSIDE_OBJECT_AFTER_COMMA":case"INSIDE_OBJECT_START":case"INSIDE_OBJECT_BEFORE_VALUE":case"INSIDE_OBJECT_AFTER_VALUE":l+="}";break;case"INSIDE_ARRAY_START":case"INSIDE_ARRAY_AFTER_COMMA":case"INSIDE_ARRAY_AFTER_VALUE":l+="]";break;case"INSIDE_LITERAL":{let t=e.substring(o,e.length);"true".startsWith(t)?l+="true".slice(t.length):"false".startsWith(t)?l+="false".slice(t.length):"null".startsWith(t)&&(l+="null".slice(t.length))}}return l}(e)})).success?{value:t.value,state:"repaired-parse"}:{value:void 0,state:"failed-parse"}}function N(e){return e.type.startsWith("tool-")||"dynamic-tool"===e.type}(0,r.bF)({prefix:"aitxt",size:24}),(0,r.bF)({prefix:"aiobj",size:24}),(0,r.bF)({prefix:"aiobj",size:24}),i.AX,((e,t)=>{for(var a in t)l(e,a,{get:t[a],enumerable:!0})})({},{object:()=>x,text:()=>O});var O=()=>({type:"text",responseFormat:{type:"text"},parsePartial:async({text:e})=>({partial:e}),parseOutput:async({text:e})=>e}),x=({schema:e})=>{let t=(0,r.C3)(e);return{type:"object",responseFormat:{type:"json",schema:t.jsonSchema},async parsePartial({text:e}){let t=await g(e);switch(t.state){case"failed-parse":case"undefined-input":return;case"repaired-parse":case"successful-parse":return{partial:t.value};default:{let e=t.state;throw Error(`Unsupported parse state: ${e}`)}}},async parseOutput({text:e},a){let o=await (0,r.NX)({text:e});if(!o.success)throw new d({message:"No object generated: could not parse the response.",cause:o.error,text:e,response:a.response,usage:a.usage,finishReason:a.finishReason});let i=await (0,r.pW)({value:o.value,schema:t});if(!i.success)throw new d({message:"No object generated: response did not match schema.",cause:i.error,text:e,response:a.response,usage:a.usage,finishReason:a.finishReason});return i.value}}};Symbol.for("vercel.ai.error.AI_NoSuchProviderError"),i.JJ;var C=s.d7({name:s.Z_(),version:s.Z_()}),D=s.d7({_meta:s.jt(s.Ry({}).loose())}),M=s.Ry({method:s.Z_(),params:s.jt(D)}),F=s.d7({experimental:s.jt(s.Ry({}).loose()),logging:s.jt(s.Ry({}).loose()),prompts:s.jt(s.d7({listChanged:s.jt(s.O7())})),resources:s.jt(s.d7({subscribe:s.jt(s.O7()),listChanged:s.jt(s.O7())})),tools:s.jt(s.d7({listChanged:s.jt(s.O7())}))});D.extend({protocolVersion:s.Z_(),capabilities:F,serverInfo:C,instructions:s.jt(s.Z_())});var w=D.extend({nextCursor:s.jt(s.Z_())}),k=s.Ry({name:s.Z_(),description:s.jt(s.Z_()),inputSchema:s.Ry({type:s.i0("object"),properties:s.jt(s.Ry({}).loose())}).loose()}).loose();w.extend({tools:s.IX(k)});var B=s.Ry({type:s.i0("text"),text:s.Z_()}).loose(),j=s.Ry({type:s.i0("image"),data:s.US(),mimeType:s.Z_()}).loose(),X=s.Ry({uri:s.Z_(),mimeType:s.jt(s.Z_())}).loose(),G=X.extend({text:s.Z_()}),J=X.extend({blob:s.US()}),U=s.Ry({type:s.i0("resource"),resource:s.G0([G,J])}).loose();D.extend({content:s.IX(s.G0([B,j,U])),isError:s.O7().default(!1).optional()}).or(D.extend({toolResult:s._4()}));var L=s.Ry({jsonrpc:s.i0("2.0"),id:s.G0([s.Z_(),s.Rx().int()])}).merge(M).strict(),P=s.Ry({jsonrpc:s.i0("2.0"),id:s.G0([s.Z_(),s.Rx().int()]),result:D}).strict(),Y=s.Ry({jsonrpc:s.i0("2.0"),id:s.G0([s.Z_(),s.Rx().int()]),error:s.Ry({code:s.Rx().int(),message:s.Z_(),data:s.jt(s._4())})}).strict(),V=s.Ry({jsonrpc:s.i0("2.0")}).merge(s.Ry({method:s.Z_(),params:s.jt(D)})).strict();s.G0([L,V,P,Y]),i.AX;var W=class{constructor({api:e="/api/chat",credentials:t,headers:a,body:o,fetch:r,prepareSendMessagesRequest:i,prepareReconnectToStreamRequest:s}){this.api=e,this.credentials=t,this.headers=a,this.body=o,this.fetch=r,this.prepareSendMessagesRequest=i,this.prepareReconnectToStreamRequest=s}async sendMessages({abortSignal:e,...t}){var a,o,i,s,l;let p=await (0,r.DB)(this.body),n=await (0,r.DB)(this.headers),c=await (0,r.DB)(this.credentials),d=await (null==(a=this.prepareSendMessagesRequest)?void 0:a.call(this,{api:this.api,id:t.chatId,messages:t.messages,body:{...p,...t.body},headers:{...n,...t.headers},credentials:c,requestMetadata:t.metadata,trigger:t.trigger,messageId:t.messageId})),_=null!=(o=null==d?void 0:d.api)?o:this.api,u=(null==d?void 0:d.headers)!==void 0?d.headers:{...n,...t.headers},y=(null==d?void 0:d.body)!==void 0?d.body:{...p,...t.body,id:t.chatId,messages:t.messages,trigger:t.trigger,messageId:t.messageId},I=null!=(i=null==d?void 0:d.credentials)?i:c,h=null!=(s=this.fetch)?s:globalThis.fetch,E=await h(_,{method:"POST",headers:{"Content-Type":"application/json",...u},body:JSON.stringify(y),credentials:I,signal:e});if(!E.ok)throw Error(null!=(l=await E.text())?l:"Failed to fetch the chat response.");if(!E.body)throw Error("The response body is empty.");return this.processResponseStream(E.body)}async reconnectToStream(e){var t,a,o,i,s;let l=await (0,r.DB)(this.body),p=await (0,r.DB)(this.headers),n=await (0,r.DB)(this.credentials),c=await (null==(t=this.prepareReconnectToStreamRequest)?void 0:t.call(this,{api:this.api,id:e.chatId,body:{...l,...e.body},headers:{...p,...e.headers},credentials:n,requestMetadata:e.metadata})),d=null!=(a=null==c?void 0:c.api)?a:`${this.api}/${e.chatId}/stream`,_=(null==c?void 0:c.headers)!==void 0?c.headers:{...p,...e.headers},u=null!=(o=null==c?void 0:c.credentials)?o:n,y=null!=(i=this.fetch)?i:globalThis.fetch,I=await y(d,{method:"GET",headers:_,credentials:u});if(204===I.status)return null;if(!I.ok)throw Error(null!=(s=await I.text())?s:"Failed to fetch the chat response.");if(!I.body)throw Error("The response body is empty.");return this.processResponseStream(I.body)}},K=class extends W{constructor(e={}){super(e)}processResponseStream(e){return(0,r.RF)({stream:e,schema:S}).pipeThrough(new TransformStream({async transform(e,t){if(!e.success)throw e.error;t.enqueue(e.value)}}))}};function q({messages:e}){let t=e[e.length-1];if(!t||"assistant"!==t.role)return!1;let a=t.parts.reduce((e,t,a)=>"step-start"===t.type?a:e,-1),o=t.parts.slice(a+1).filter(N);return o.length>0&&o.every(e=>"output-available"===e.state)}var z=s.Ry({type:s.i0("text"),text:s.Z_(),state:s.Km(["streaming","done"]).optional(),providerMetadata:y.optional()}),$=s.Ry({type:s.i0("reasoning"),text:s.Z_(),state:s.Km(["streaming","done"]).optional(),providerMetadata:y.optional()}),H=s.Ry({type:s.i0("source-url"),sourceId:s.Z_(),url:s.Z_(),title:s.Z_().optional(),providerMetadata:y.optional()}),Q=s.Ry({type:s.i0("source-document"),sourceId:s.Z_(),mediaType:s.Z_(),title:s.Z_(),filename:s.Z_().optional(),providerMetadata:y.optional()}),ee=s.Ry({type:s.i0("file"),mediaType:s.Z_(),filename:s.Z_().optional(),url:s.Z_(),providerMetadata:y.optional()}),et=s.Ry({type:s.i0("step-start")}),ea=s.Ry({type:s.Z_().startsWith("data-"),id:s.Z_().optional(),data:s._4()}),eo=[s.Ry({type:s.i0("dynamic-tool"),toolName:s.Z_(),toolCallId:s.Z_(),state:s.i0("input-streaming"),input:s._4().optional(),output:s.Fi().optional(),errorText:s.Fi().optional()}),s.Ry({type:s.i0("dynamic-tool"),toolName:s.Z_(),toolCallId:s.Z_(),state:s.i0("input-available"),input:s._4(),output:s.Fi().optional(),errorText:s.Fi().optional(),callProviderMetadata:y.optional()}),s.Ry({type:s.i0("dynamic-tool"),toolName:s.Z_(),toolCallId:s.Z_(),state:s.i0("output-available"),input:s._4(),output:s._4(),errorText:s.Fi().optional(),callProviderMetadata:y.optional(),preliminary:s.O7().optional()}),s.Ry({type:s.i0("dynamic-tool"),toolName:s.Z_(),toolCallId:s.Z_(),state:s.i0("output-error"),input:s._4(),output:s.Fi().optional(),errorText:s.Z_(),callProviderMetadata:y.optional()})],er=[s.Ry({type:s.Z_().startsWith("tool-"),toolCallId:s.Z_(),state:s.i0("input-streaming"),input:s._4().optional(),output:s.Fi().optional(),errorText:s.Fi().optional()}),s.Ry({type:s.Z_().startsWith("tool-"),toolCallId:s.Z_(),state:s.i0("input-available"),input:s._4(),output:s.Fi().optional(),errorText:s.Fi().optional(),callProviderMetadata:y.optional()}),s.Ry({type:s.Z_().startsWith("tool-"),toolCallId:s.Z_(),state:s.i0("output-available"),input:s._4(),output:s._4(),errorText:s.Fi().optional(),callProviderMetadata:y.optional(),preliminary:s.O7().optional()}),s.Ry({type:s.Z_().startsWith("tool-"),toolCallId:s.Z_(),state:s.i0("output-error"),input:s._4(),output:s.Fi().optional(),errorText:s.Z_(),callProviderMetadata:y.optional()})];s.Ry({id:s.Z_(),role:s.Km(["system","user","assistant"]),metadata:s._4().optional(),parts:s.IX(s.G0([z,$,H,Q,ee,et,ea,...eo,...er]))})}}]);
//# sourceMappingURL=ba12c10f-aaafcb074f608624.js.map