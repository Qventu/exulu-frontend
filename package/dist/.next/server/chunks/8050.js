"use strict";exports.id=8050,exports.ids=[8050],exports.modules={43273:(e,s,t)=>{t.d(s,{Cd:()=>d,X:()=>c,bZ:()=>o});var a=t(10326),l=t(79360),n=t(17577),i=t(77863);let r=(0,l.j)("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive",info:"border-info/50 text-info dark:border-info [&>svg]:text-info"}},defaultVariants:{variant:"default"}}),o=n.forwardRef(({className:e,variant:s,...t},l)=>a.jsx("div",{ref:l,role:"alert",className:(0,i.cn)(r({variant:s}),e),...t}));o.displayName="Alert";let d=n.forwardRef(({className:e,...s},t)=>a.jsx("h5",{ref:t,className:(0,i.cn)("mb-1 font-medium leading-none tracking-tight",e),...s}));d.displayName="AlertTitle";let c=n.forwardRef(({className:e,...s},t)=>a.jsx("div",{ref:t,className:(0,i.cn)("text-sm [&_p]:leading-relaxed",e),...s}));c.displayName="AlertDescription"},77961:(e,s,t)=>{t.d(s,{jF:()=>W,jU:()=>U,ZP:()=>F,NF:()=>_});var a=t(10326),l=t(17577);t(32964),t(59946),t(27221);var n=t(59161),i=t(30463);let r=function(e,s=[]){(0,l.useContext)(i.E);let[t,a]=(0,l.useState)(void 0);return t};var o=t(84714),d=t(31540),c=t(15557),x=t(61086),m=t(11890),u=t(39183),p=t(36283),h=t(71709),j=t(39572),g=t(83855),f=t(94019),N=t(3240),v=t(90772),y=t(62288),w=t(65685),b=t(3574),k=t(20108),C=t(10119),Z=t(54432),z=t(76812),L=t(33071),O=t(65304);function W({s3key:e,children:s}){let{data:t,isLoading:l,error:i,refetch:r}=(0,k.a)({queryKey:["fileObject",e],queryFn:async()=>e?await n.QZ.object(e):null,enabled:null!=e});return e?(0,a.jsxs)(L.Zb,{children:[a.jsx(L.Ol,{className:"pb-3",children:a.jsx(L.ll,{className:"text-sm truncate",children:e.split("_EXULU_").pop()})}),(0,a.jsxs)(L.aY,{className:"pt-0",children:[l&&(0,a.jsxs)("div",{className:"space-y-2",children:[a.jsx(O.O,{className:"h-4 w-full"}),a.jsx(O.O,{className:"h-4 w-2/3"})]}),!l&&t&&(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between text-xs text-muted-foreground",children:[a.jsx("span",{className:"capitalize",children:t?.ContentType.split("/").pop()}),(0,a.jsxs)("span",{children:[(t?.ContentLength/1024/1024).toFixed(2)," MB"]})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between text-xs text-muted-foreground",children:[(0,a.jsxs)("span",{children:["Last modified: ",new Date(t?.LastModified).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"})]}),(0,a.jsxs)(v.z,{variant:"secondary",size:"sm",type:"button",className:"h-7 px-2",onClick:()=>{n.QZ.download(e).then(async e=>{console.log("res",e);let s=await e.json();console.log("res",s);let t=s.url;window.open(t,"_blank")})},children:[a.jsx("span",{className:"mr-1 text-xs",children:"View"}),a.jsx(d.Z,{className:"h-3 w-3"})]})]})]}),!l&&i&&a.jsx("p",{className:"text-xs text-muted-foreground",children:i.message}),s]})]}):a.jsx(L.Zb,{children:(0,a.jsxs)(L.aY,{className:"p-3 flex",children:[a.jsx("p",{className:"text-sm text-muted-foreground m-auto",children:"No file selected"}),s]})})}function F({id:e,allowedFileTypes:s,dependencies:t,onConfirm:n,selectionLimit:i,buttonText:r}){let[o,d]=(0,l.useState)(!1);return(0,a.jsxs)(y.Vq,{open:o,onOpenChange:d,children:[a.jsx(y.hg,{asChild:!0,children:(0,a.jsxs)(v.z,{variant:"outline",children:[r&&a.jsx("span",{className:"mr-2",children:r}),a.jsx(c.Z,{className:"h-4 w-4"})]})}),(0,a.jsxs)(y.cZ,{className:"sm:max-w-[900px]",children:[(0,a.jsxs)(y.fK,{children:[a.jsx(y.$N,{children:"File Gallery"}),a.jsx(y.Be,{children:"Browse your previously uploaded files or upload new ones."})]}),a.jsx(S,{id:e,allowedFileTypes:s,dependencies:t,selectionLimit:i,onConfirm:e=>{n(e),d(!1)}})]})]})}let S=({id:e,allowedFileTypes:s,dependencies:t,onConfirm:d,selectionLimit:c})=>{s||(s=[".png",".jpg",".jpeg",".gif",".webp",".pdf",".docx",".xlsx",".xls",".csv",".pptx",".ppt",".mp3",".wav",".m4a",".mp4",".mpeg",".mp4",".m4a",".mp3",".mpeg",".wav"]);let[p,h]=(0,l.useState)(void 0),[j,g]=(0,l.useState)(void 0),[f,N]=(0,l.useState)(void 0),y=(0,l.useContext)(i.E),[L,W]=(0,l.useState)([]),F=e=>{if(L.includes(e)){W(L.filter(s=>s!==e));return}if(1===c){W([e]);return}L.length>=c||W([...L,e])},S=(0,C.D)({mutationFn:async({key:e})=>{await n.QZ.delete(e),A()}}),{data:K,isLoading:_,error:q,refetch:A}=(0,k.a)({queryKey:["filesQuery",p,f],staleTime:3e4,queryFn:async()=>n.QZ.list({search:p,continuationToken:f})});console.log("!! data !!",K);let{theme:Q}=(0,b.F)(),T=r({backend:y?.backend||"",uppyOptions:{id:e,allowedFileTypes:s},callbacks:{uploadSuccess:async e=>{console.log("data",e)}},maxNumberOfFiles:10},t);return((0,l.useEffect)(()=>{A()},[p,f]),T)?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mt-4",children:[(0,a.jsxs)("div",{className:"border rounded-lg p-4",children:[a.jsx("h3",{className:"text-sm font-medium mb-3",children:"Previously Uploaded Files"}),a.jsx(Z.I,{placeholder:"Search files...",value:p,onChange:e=>h(e.target.value),className:"mb-3"}),(0,a.jsxs)("div",{className:"flex items-center justify-between text-xs text-muted-foreground pb-2",children:[(0,a.jsxs)("span",{children:[L.length," / ",c," files selected"]}),(0,a.jsxs)("span",{children:["Allowed file types: ",s?.map(e=>e).join(", ")]})]}),(0,a.jsxs)(w.x,{children:[_&&(0,a.jsxs)("div",{className:"flex items-center justify-center h-full w-full grid grid-cols-2 sm:grid-cols-3 gap-3",children:[a.jsx(O.O,{className:"h-[120px] w-full"}),a.jsx(O.O,{className:"h-[120px] w-full"}),a.jsx(O.O,{className:"h-[120px] w-full"}),a.jsx(O.O,{className:"h-[120px] w-full"}),a.jsx(O.O,{className:"h-[120px] w-full"}),a.jsx(O.O,{className:"h-[120px] w-full"}),a.jsx(O.O,{className:"h-[120px] w-full"}),a.jsx(O.O,{className:"h-[120px] w-full"}),a.jsx(O.O,{className:"h-[120px] w-full"})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-3",children:[!_&&!K?.Contents?.length&&(0,a.jsxs)("div",{className:"col-span-full flex flex-col items-center justify-center py-12 text-center",children:[a.jsx(x.Z,{className:"h-12 w-12 text-muted-foreground/50 mb-3"}),a.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Nothing to see here... yet!"}),a.jsx("p",{className:"text-xs text-muted-foreground/75 mt-1",children:"Upload some files to get started"})]}),K?.Contents?.map(e=>a.jsx(U,{s3Key:e.Key,onSelect:F,active:L.some(s=>s===e.Key),onRemove:()=>{S.mutate({key:e.Key})},disabled:!!s&&!s?.some(s=>e.Key.endsWith(s))}))]}),a.jsx("div",{className:"flex items-center space-x-6 lg:space-x-8 pt-3",children:(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsxs)(v.z,{variant:"outline",className:"hidden size-8 p-0 lg:flex",onClick:()=>{N(void 0)},disabled:!f||_,children:[a.jsx("span",{className:"sr-only",children:"Go to first page"}),a.jsx(z.kRt,{className:"size-4"})]}),(0,a.jsxs)(v.z,{variant:"outline",className:"size-8 p-0",onClick:()=>{N(j)},disabled:!f||_,children:[a.jsx("span",{className:"sr-only",children:"Go to previous page"}),a.jsx(m.Z,{className:"size-4"})]}),(0,a.jsxs)(v.z,{variant:"outline",className:"size-8 p-0",onClick:()=>{g(f),N(K?.NextContinuationToken)},disabled:!K?.NextContinuationToken||_,children:[a.jsx("span",{className:"sr-only",children:"Go to next page"}),a.jsx(u.Z,{className:"size-4"})]})]})})]})]}),(0,a.jsxs)("div",{className:"border rounded-lg p-4",children:[a.jsx("h3",{className:"text-sm font-medium mb-3",children:"Upload New Files"}),a.jsx(o.A,{uppy:T,theme:"dark"===Q?"dark":"light"})]})]}),a.jsx("div",{className:"flex justify-end",children:a.jsx(v.z,{variant:"outline",onClick:()=>{d(L),W([])},children:"Confirm"})})]}):null},U=({s3Key:e,onSelect:s,onRemove:t,active:l,disabled:i,addToContext:r})=>{let o;return(0,a.jsxs)("div",{className:`${i?"opacity-50":""} group relative rounded-lg p-2 hover:bg-muted transition-colors cursor-pointer ${l?"border border-purple-500":"border"}`,onClick:()=>{!i&&s&&s(e)},children:[a.jsx("div",{className:"aspect-square relative mb-2 bg-muted/50 rounded-md overflow-hidden flex items-center justify-center",children:e&&(e.toLowerCase().endsWith("jpg")||e.toLowerCase().endsWith("jpeg")||e.toLowerCase().endsWith("png")||e.toLowerCase().endsWith("svg"))?a.jsx(q,{fileKey:e}):(0,a.jsxs)("div",{className:"flex flex-col items-center justify-center h-full",children:[(o=e)?o.toLowerCase().endsWith("jpg")||o.toLowerCase().endsWith("jpeg")||o.toLowerCase().endsWith("png")||o.toLowerCase().endsWith("svg")?a.jsx(h.Z,{className:"h-6 w-6 text-blue-500"}):o.endsWith("pdf")?a.jsx(j.Z,{className:"h-6 w-6 text-red-500"}):o.endsWith("xls")||o.endsWith("xlsx")||o.endsWith("csv")?a.jsx(p.Z,{className:"h-6 w-6 text-green-500"}):o.endsWith("ppt")||o.endsWith("pptx")?a.jsx(p.Z,{className:"h-6 w-6 text-orange-500"}):a.jsx(p.Z,{className:"h-6 w-6 text-gray-500"}):a.jsx(p.Z,{className:"h-6 w-6 text-gray-500"}),a.jsx("span",{className:"text-xs text-muted-foreground mt-1 text-center",children:e?e.split("_EXULU_").pop():e})]})}),a.jsx("p",{className:"text-xs truncate",children:e?e.split("_EXULU_").pop():e}),(0,a.jsxs)("div",{className:"opacity-0 group-hover:opacity-100 flex absolute top-1 right-1",children:[r&&(0,a.jsxs)(v.z,{variant:"ghost",size:"icon",type:"button",className:"h-6 w-6 bg-background/80 hover:bg-background",onClick:()=>{r(e)},children:[a.jsx(g.Z,{className:"h-3 w-3"}),a.jsx("span",{className:"sr-only",children:"Add"})]}),(0,a.jsxs)(v.z,{variant:"ghost",size:"icon",type:"button",className:"h-6 w-6 bg-background/80 hover:bg-background",onClick:()=>{n.QZ.download(e).then(async e=>{console.log("res",e);let s=await e.json();console.log("res",s);let t=s.url;window.open(t,"_blank")})},children:[a.jsx(d.Z,{className:"h-3 w-3"}),a.jsx("span",{className:"sr-only",children:"View"})]}),t&&(0,a.jsxs)(v.z,{onClick:s=>{s.stopPropagation(),t(e)},variant:"ghost",type:"button",size:"icon",className:"h-6 w-6 opacity-0 group-hover:opacity-100 bg-background/80 hover:bg-background ml-1",children:[a.jsx(f.Z,{className:"h-3 w-3"}),a.jsx("span",{className:"sr-only",children:"Remove"})]})]})]},e)},K={},_=async e=>{if(K[e]){if(!(K[e].expiresAt<Date.now()))return K[e].url;delete K[e]}let s=await n.QZ.download(e),t=await s.json();return console.log("json",t),K[e]={url:t.url,expiresAt:Date.now()+6e4},t.url},q=({fileKey:e})=>{console.log("key",e);let s=(0,k.a)({queryKey:["imageQuery",e],staleTime:3e4,queryFn:async()=>_(e)});return s.isLoading?a.jsx("div",{children:a.jsx(N.Z,{})}):s.isLoading||s.data?a.jsx("img",{src:s.data,alt:e,className:"object-cover w-full h-full"}):a.jsx("div",{children:a.jsx(x.Z,{})})}}};